<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
body  {
    background-image: url('/images/field.jpg');
	-webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    background-repeat: no-repeat;
    background-attachment: fixed;
}

#counties{
  position: absolute;
  top: 800px;
  left: 35%;
  transform: translate(-50%, -50%);
}

#fileIN{
top: 60%;
left: 45%;
position: fixed;
}

h1{
 font-family: "Courier New", "Helvetica", Times, serif;
 top: 50%;
 text-align: center;
 color: white;

}


</style>




</head>


<body>
<script src="javascript/d3.v3.min.js"></script>
<script src="javascript/topojson.v1.min.js"></script>
<script src="javascript/datamaps.usa.min.js"></script>
<script src="javascript/papaparse.min.js"></script>
<script src="javascript/ParseData.js"></script>

<h1>4th District Swing County Map</h1>





<div id="counties" style="height: 800%; width: 400%;"></div>

<div id="fileIN">
<input type="file"/>
</div>

<script>
var darkblue = 'Navy';
var mediumblue = 'MediumBlue';
var DodgerBlue = 'DodgerBlue';
var deepskyblue = 'DeepSkyBlue';
var powderblue = 'PowderBlue';
var pink = 'Pink';
var lightsalmon = 'LightSalmon';
var salmon = 'Salmon';
var orangered = 'OrangeRed';
var red = 'Red';



var map = new Datamap({
    element: document.getElementById('counties'),
    geographyConfig: {
      dataUrl: 'topoJSON/Iowa.topo.json',
      highlightFillColor: '#FC8D59',
    },
    scope: 'Iowa.geo',
  fills: {
	    SUPER_STRONG_REPUBLICAN: '#A20007',
            PRETTY_STRONG_REPUBLICAN: '#CE0000',
            FAIRLY_STRONG_REPUBLICAN: '#DF686B',
            STRONG_REPUBLICAN: '#EC979A',
            REPUBLICAN:'#EFCACB',
            DEMOCRAT: '#CAE1F8',
            STRONG_DEMOCRAT: '#A3CAEE',
            FAIRLY_STRONG_DEMOCRAT: '#6DA5D6',
            PRETTY_STRONG_DEMOCRAT: '#4185C2',
            SUPER_STRONG_DEMOCRAT: '#09508E',
      	    defaultFill: 'LightSlateGray' 
},
    setProjection: function(element, options) {
      var projection, path;
      projection = d3.geo.albersUsa()
        .scale(element.offsetWidth)
        .translate([element.offsetWidth / 2, element.offsetHeight / 2  ]);
      path = d3.geo.path()
        .projection( projection );
      return {path: path, projection: projection};
    }
  });



function changeColor(countyCode, color){
  var obj = {};
  obj[countyCode] = color;
  map.updateChoropleth(obj);
}

var updateMap = function(arr) {


for(var i =1; i<arr.length; i++){
	var name;
	if(i==3){
	name = 'BuenaVista';
	}
	else if(i==7){
	name = 'CerroGordo';
	}
	else if(i==27){
	name = 'OBrien';
	}
	else if(i==29){
	name = 'PaloAlto';
	}
	else{
	name = arr[i][0];
	}
var type = getType(arr[i][8]);
changeColor(name, type);
}


};





window.onload = function parseData(){
  Papa.parse("data/data.csv", {
    download: true,
    complete: function(results) {
      updateMap(results.data);
    }
  });
}

 








function getType(num){
if(num>=-1 && num<-.8){
return pink;
}
else if(num>=-.8 && num<-.6){
return orangered;
}
else if(num>=-.6 && num<-.4){
return salmon;
}
else if(num>=-.4 && num<-.2){
return lightsalmon;
}
else if(num>=-.2 && num<0){
return pink;
}
else if(num>=0 && num<.2){
return powderblue;
}
else if(num>=.2 && num<.4){
return deepskyblue;
}
else if(num>=.4 && num<.6){
return DodgerBlue;
}
else if(num>.6 && num<.8){
return mediumblue;
}
else if(num>.8 && num<1){
return darkblue;
}
}

</script>
</body>


</body>
</html>
